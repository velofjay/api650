{
  "metadata": {
    "title": "API 650 (12th, 2013) \u2013 Calculation Blueprint for Tank Design App",
    "source_file": "API 650 12th_2013.pdf",
    "generated_at": "2025-08-29T19:36:20.777750",
    "notes": [
      "This JSON lists inputs, outputs, and formula references (with clause numbers) to implement an API 650 calculator.",
      "Equations marked 'lookup' are table-driven per API 650; implement as data lookups."
    ]
  },
  "inputs": {
    "geometry": {
      "D": {
        "unit": "m",
        "desc": "Tank internal diameter"
      },
      "H": {
        "unit": "m",
        "desc": "Design liquid height to top of shell (or roof-to-shell junction as applicable)"
      },
      "num_courses": {
        "unit": "-",
        "desc": "Number of shell courses (if fixed)"
      },
      "roof_type": {
        "unit": "-",
        "desc": "Cone, dome, supported, self-supporting, external/ internal floating roof"
      }
    },
    "material": {
      "shell_material": {
        "unit": "-",
        "desc": "Material grade per API 650 Tables 5.2a/5.2b"
      },
      "S_allow": {
        "unit": "MPa",
        "desc": "Allowable stress from Table 5.2a (SI) or 5.2b (USC)"
      },
      "joint_efficiency_E": {
        "unit": "-",
        "desc": "Weld joint efficiency (typ. 0.85/1.0 as per joint/category)"
      }
    },
    "design": {
      "CA_shell": {
        "unit": "mm",
        "desc": "Corrosion allowance (shell)"
      },
      "CA_bottom": {
        "unit": "mm",
        "desc": "Corrosion allowance (bottom plates)"
      },
      "G": {
        "unit": "-",
        "desc": "Specific gravity of stored liquid"
      },
      "wind": {
        "V": {
          "unit": "km/h",
          "desc": "3-sec gust wind speed at 10 m (per 5.2.1[k])"
        },
        "Kz": {
          "unit": "-",
          "desc": "Velocity pressure exposure coef."
        },
        "Kzt": {
          "unit": "-",
          "desc": "Topographic factor"
        },
        "Kd": {
          "unit": "-",
          "desc": "Directionality factor"
        },
        "I": {
          "unit": "-",
          "desc": "Importance factor"
        },
        "Gf": {
          "unit": "-",
          "desc": "Gust factor"
        }
      },
      "seismic": {
        "Ss": {
          "unit": "g",
          "desc": "Mapped spectral acceleration at short period (site)"
        },
        "S1": {
          "unit": "g",
          "desc": "Mapped spectral acceleration at 1.0 s"
        },
        "site_class": {
          "unit": "-",
          "desc": "Per Annex E/ASCE 7 site class"
        },
        "R": {
          "unit": "-",
          "desc": "Response modification / ductility factor per Annex E"
        },
        "Ie": {
          "unit": "-",
          "desc": "Importance factor (seismic)"
        }
      },
      "annular": {
        "has_annular": {
          "unit": "bool",
          "desc": "Annular bottom provided"
        },
        "edge_distance_s": {
          "unit": "mm",
          "desc": "Shell-to-annular edge distance (for width check)"
        }
      }
    },
    "access": {
      "stair_style": {
        "unit": "-",
        "desc": "Straight (radial) or circumferential/helix per Annex L guidance"
      },
      "stair_clear_width": {
        "unit": "mm",
        "desc": "Clear walking width (\u2265710 mm per Table 5.18)"
      },
      "stair_angle_deg": {
        "unit": "deg",
        "desc": "Stairway angle to horizontal (\u226450\u00b0 per Table 5.18)"
      },
      "tread_run": {
        "unit": "mm",
        "desc": "Run between tread noses (per Table 5.18/5.19)"
      },
      "tread_rise": {
        "unit": "mm",
        "desc": "Rise of tread (per Table 5.18/5.19)"
      },
      "tread_type": {
        "unit": "-",
        "desc": "Grating / nonslip as per Table 5.18"
      },
      "handrail_height": {
        "unit": "mm",
        "desc": "Top rail height (760\u2013860 mm per Table 5.18)"
      },
      "railing_post_spacing": {
        "unit": "mm",
        "desc": "Max spacing along slope (\u22642400 mm per Table 5.18)"
      },
      "handrail_load": {
        "unit": "N",
        "desc": "Design point load on handrail (\u2265900 N any direction per Table 5.18)"
      },
      "moving_concentrated_load": {
        "unit": "N",
        "desc": "Structure moving concentrated load (\u22654450 N per Table 5.18)"
      },
      "stair_shell_clearance_circ": {
        "unit": "mm",
        "desc": "Clearance for circular stairs (if >200 mm, handrails both sides)"
      },
      "platform_handrail_both_sides": {
        "unit": "bool",
        "desc": "Handrails both sides of platform per handrail rules"
      },
      "walkway_gap_floored_over": {
        "unit": "bool",
        "desc": "Floor any gap >150 mm between tank and platform at handrail openings"
      }
    },
    "nozzles": {
      "count_nozzles": {
        "unit": "-",
        "desc": "Total number of process/drain/overflow nozzles"
      },
      "count_manholes": {
        "unit": "-",
        "desc": "Total number of manholes (shell/roof)"
      },
      "list": {
        "schema": {
          "tag": "string",
          "type": "shell|roof|bottom|manhole|cleanout",
          "service": "e.g., inlet/outlet/recirc/drain/vent/foam",
          "elevation_m": "float",
          "nps_inch": "float",
          "diameter_mm": "float",
          "required_flow_m3_h": "float",
          "design_pressure_bar": "float",
          "design_temperature_C": "float",
          "material": "string",
          "corrosion_allowance_mm": "float",
          "desired_velocity_m_s": "float (optional; default by service)"
        },
        "note": "Provide one object per nozzle/manhole. For manholes, set service='manhole' and provide standard size."
      }
    }
  },
  "outputs": {
    "thicknesses": [
      "shell_thickness_by_course",
      "roof_plate_thickness",
      "bottom_plate_thickness",
      "annular_plate_thickness"
    ],
    "annular": [
      "annular_plate_width"
    ],
    "stability": [
      "wind_stiffening_rings",
      "max_unstiffened_height_H1",
      "seismic_shear_and_overturning"
    ],
    "anchorage": [
      "need_for_anchor_chairs",
      "num_anchor_chairs",
      "anchor_chair_dimensions",
      "anchor_bolt_diameter",
      "anchor_bolt_length"
    ],
    "members": [
      "wind_gerder_size",
      "curb_angle_size"
    ],
    "weights": [
      "per_component_weights",
      "total_weight"
    ],
    "bom": [
      "plate_MTO",
      "structural_MTO",
      "bolt_MTO",
      "nozzle_appurtenance_MTO",
      "access_MTO"
    ],
    "access": [
      "stair_geometry_summary",
      "number_of_treads",
      "landing_requirements",
      "handrail_configuration",
      "post_count_and_spacing",
      "stair_supporting_details"
    ],
    "nozzles": [
      "nozzle_size_selection",
      "nozzle_schedule_selection",
      "nozzle_reinforcement_check",
      "nozzle_allowable_loads_annexP",
      "nozzle_stress_summary"
    ]
  },
  "formulas": [
    {
      "id": "capacity_A4_1",
      "title": "Nominal Capacity (USC units reference)",
      "clause": "Annex A.4.1",
      "equation": "C = 0.14 * D^2 * H",
      "variables": {
        "C": "Capacity, 42-gal barrels",
        "D": "Diameter (ft)",
        "H": "Height (ft)"
      },
      "type": "geometry",
      "citation_hint": "See Annex A table note with capacity formula."
    },
    {
      "id": "wind_velocity_pressure_5_9_note2",
      "title": "Velocity Pressure",
      "clause": "5.9.7.2 Note 2",
      "equation": "p = 0.00256 * Kz * Kzt * Kd * V^2 * I * G",
      "variables": {
        "p": "Velocity pressure",
        "Kz": "Exposure coef.",
        "Kzt": "Topographic factor",
        "Kd": "Directionality factor",
        "V": "3-sec gust speed (mph)",
        "I": "Importance factor",
        "G": "Gust factor"
      },
      "type": "wind"
    },
    {
      "id": "wind_unstiffened_height_H1_5_9",
      "title": "Max Unstiffened Shell Height against Wind Buckling",
      "clause": "5.9.7.1/5.9.7.2",
      "equation": "H1 = f(D, t_top, p)  # per API 650 buckling criterion",
      "variables": {
        "H1": "Critical height",
        "D": "Tank diameter",
        "t_top": "Top course nominal thickness",
        "p": "Total external pressure incl. vacuum"
      },
      "type": "wind",
      "implementation_note": "Use API 650 buckling expression (modified U.S. Model Basin) with total pressure per Note 2."
    },
    {
      "id": "transpose_width_5_9_7_2",
      "title": "Transposed Width for Transformed Shell",
      "clause": "5.9.7.2",
      "equation": "Wtr = W * (t_uniform / t_course)",
      "variables": {
        "Wtr": "Transposed width",
        "W": "Actual course width",
        "t_uniform": "Nominal thickness of thinnest shell course",
        "t_course": "Nominal thickness of the course"
      },
      "type": "wind"
    },
    {
      "id": "annular_thickness_5_1",
      "title": "Annular Bottom Plate Minimum Thickness",
      "clause": "5.5 & Tables 5.1a/5.1b",
      "equation": "tb = lookup(D)  # per Table 5.1a/5.1b",
      "variables": {
        "tb": "Annular plate min thickness",
        "D": "Tank diameter"
      },
      "type": "bottom"
    },
    {
      "id": "shell_thickness_5_6",
      "title": "Shell Thickness (Hydrostatic) \u2013 One-foot or Variable Design Point",
      "clause": "5.6 & Annex K",
      "equation": "t = function(H_local, D, G, S_allow, E) + CA_shell",
      "variables": {
        "t": "Required thickness",
        "H_local": "Liquid height at course bottom",
        "D": "Diameter",
        "G": "Specific gravity",
        "S_allow": "Allowable stress",
        "E": "Joint efficiency",
        "CA_shell": "Corrosion allowance"
      },
      "type": "shell"
    },
    {
      "id": "roof_thickness_5_10",
      "title": "Roof Plate Thickness (Self-supporting Roofs)",
      "clause": "5.10 (plus Annex V for external pressure checks if applicable)",
      "equation": "t_roof = f(D, roof_type, loads)",
      "variables": {
        "t_roof": "Roof plate thickness",
        "D": "Diameter",
        "loads": "Dead + live + wind/snow as applicable"
      },
      "type": "roof"
    },
    {
      "id": "bottom_thickness_5_4",
      "title": "Bottom Plate Thickness",
      "clause": "5.4",
      "equation": "t_bottom >= minimums per 5.4; corrosion allowance added as applicable",
      "variables": {
        "t_bottom": "Bottom plate thickness"
      },
      "type": "bottom"
    },
    {
      "id": "annular_width_5_5",
      "title": "Annular Plate Width",
      "clause": "5.5",
      "equation": "b >= max(edge distance rules, shell load path requirements)",
      "variables": {
        "b": "Annular plate radial width"
      },
      "type": "bottom"
    },
    {
      "id": "wind_gerder_5_9",
      "title": "Wind Girder (Top/Intermediate Stiffening Ring)",
      "clause": "5.9",
      "equation": "Select section modulus/area to resist compressive hoop from external pressure; spacing per H1/transform rules",
      "variables": {
        "section": "Required ring section",
        "location": "Elevation(s)"
      },
      "type": "wind"
    },
    {
      "id": "curb_angle_5_10",
      "title": "Curb Angle Sizing",
      "clause": "5.10",
      "equation": "Select per roof-edge detail load path; thickness/leg per clause tables/details",
      "variables": {
        "size": "Angle size"
      },
      "type": "roof"
    },
    {
      "id": "anchorage_need_5_11_5_12",
      "title": "Need for Anchorage and Number of Anchor Chairs",
      "clause": "5.11 & 5.12",
      "equation": "Check overturning stability; if uplift > resisting weight, design anchors; N = ceil(Total_uplift / capacity_per_chair)",
      "variables": {
        "N": "Number of chairs",
        "capacity_per_chair": "Allowable uplift per chair"
      },
      "type": "anchorage"
    },
    {
      "id": "anchor_bolt_5_12",
      "title": "Anchor Bolt Diameter & Length",
      "clause": "5.12",
      "equation": "Select bolt dia/length to develop required tensile capacity with embedment and edge distances per 5.12",
      "variables": {
        "db": "Bolt diameter",
        "Lb": "Embedment/length"
      },
      "type": "anchorage"
    },
    {
      "id": "seismic_annexE_base_shear",
      "title": "Seismic Base Shear",
      "clause": "Annex E",
      "equation": "V = Cs * W_eff",
      "variables": {
        "V": "Base shear",
        "Cs": "Seismic coefficient per spectra & tank period",
        "W_eff": "Effective weight of liquid + tank"
      },
      "type": "seismic"
    },
    {
      "id": "seismic_overturning_annexE",
      "title": "Seismic Overturning Moment",
      "clause": "Annex E (EC.10)",
      "equation": "M_o = function(Ci, W_eff, Hc, sloshing)",
      "variables": {
        "M_o": "Overturning moment",
        "Ci": "Coefficient from spectra",
        "Hc": "Height of effective force application"
      },
      "type": "seismic"
    },
    {
      "id": "weights_bom",
      "title": "Weights and BOM",
      "clause": "Commercial/General",
      "equation": "Weight = density * area_or_length * thickness (plates/sections); sum by component; generate MTO",
      "variables": {
        "density": "7850 kg/m3 for carbon steel unless specified"
      },
      "type": "MTO"
    },
    {
      "id": "stair_min_requirements_table_5_18",
      "title": "Stairway & Handrail Minimums",
      "clause": "Table 5.18 (Section 5)",
      "equation": "check(stair_clear_width >= 710 mm, stair_angle_deg <= 50, handrail_height in [760, 860], railing_post_spacing <= 2400) and loads >= {moving_concentrated: 4450 N, handrail: 900 N}",
      "variables": {
        "stair_clear_width": "mm",
        "stair_angle_deg": "deg",
        "handrail_height": "mm",
        "railing_post_spacing": "mm",
        "moving_concentrated_load": "N",
        "handrail_load": "N"
      },
      "type": "access",
      "notes": [
        "Handrails both sides of straight stairs; both sides of circular stairs if shell-stringer clearance >200 mm.",
        "Circumferential stairs fully supported on shell; ends clear of ground; extend bottom-to-roof landing."
      ]
    },
    {
      "id": "stair_rise_run_table_5_19",
      "title": "Rise\u2013Run\u2013Angle Relationships",
      "clause": "Table 5.19a/5.19b",
      "equation": "verify(2*R + r in [610, 660]) and angle = f(R, r) per table",
      "variables": {
        "R": "Rise (mm or in.)",
        "r": "Run (mm or in.)",
        "angle": "degrees"
      },
      "type": "access",
      "implementation_note": "Provide discrete table mapping; choose combination that meets width/angle constraints."
    },
    {
      "id": "platform_handrail_rules",
      "title": "Platform Handrail & Runway Rules",
      "clause": "Section 5 (Handrail/platform notes)",
      "equation": "handrails_on_both_sides(platform)=true; floor_gap_if_gap>150mm; allow_runway_relative_movement via slip joint",
      "type": "access"
    },
    {
      "id": "stairway_opening_through_ring_fig_5_25",
      "title": "Stairway Opening Through Stiffening Ring",
      "clause": "Figure 5.25, 5.9 interface",
      "equation": "Detail opening b_min and bars (A\u2013E); ensure compatibility with ring sizing and H1 buckling checks",
      "type": "access",
      "implementation_note": "Coordinate with ring section per 5.9 & Figure 5.24, and transformed shell method 5.9.7.2"
    },
    {
      "id": "shell_openings_5_7",
      "title": "Shell Openings\u2014Design & Reinforcement",
      "clause": "5.7 (Shell Openings)",
      "equation": "Use Tables 5.3a\u20135.12b for standard opening details and reinforcement; if size is intermediate, use next larger (5.7.1.4). Minimize external loads near bottom; consider rotation (5.7.1.5).",
      "type": "nozzles"
    },
    {
      "id": "annexP_external_loads",
      "title": "Allowable External Loads on Tank Shell Openings",
      "clause": "Annex P (P.2 Limit Loads / P.3 Allowable Stress)",
      "equation": "Evaluate piping loads at opening using FR (radial force), ML (longitudinal moment), MC (circumferential moment). Compare to Annex P limit/allowable values using stiffness coefficients (Figures P.2*), boundaries (P.3).",
      "type": "nozzles"
    },
    {
      "id": "small_internal_pressure_annexF",
      "title": "Small Internal Pressure Effects",
      "clause": "Annex F",
      "equation": "If internal design pressure is non-negligible, verify shell/opening and roof details per Annex F limits.",
      "type": "nozzles"
    },
    {
      "id": "nozzle_velocity_based_size_selection",
      "title": "Nozzle NPS Selection by Flow/Velocity Target",
      "clause": "Good practice (piping)\u2014not an API 650 formula",
      "equation": "Select NPS to keep velocity within service limits (e.g., liquids 1\u20133 m/s suction, 2\u20134 m/s discharge; drains/vents lower).",
      "type": "piping"
    },
    {
      "id": "nozzle_schedule_by_pressure",
      "title": "Nozzle Neck Schedule by Pressure/Material",
      "clause": "ASME B31.3/B36.10M (external reference)",
      "equation": "Use Barlow/allowable pressure equations or code tables to select schedule for given design pressure, temperature, material, E, CA.",
      "type": "piping"
    }
  ],
  "materials": {
    "metadata": {
      "section": "4.2 Plates (API 650 12th, 2013)",
      "notes": [
        "Mechanical and chemical requirements reference Table 4.2 (and related 4.2.x clauses).",
        "Temperature applicability and impact testing reference Figures 4.1a/4.1b and Tables 4.3/4.5; implement as lookups.",
        "This list includes families specified in 4.2.2\u20134.2.6 (ASTM, CSA G40.21, ISO 630, EN 10025, and national standards).",
        "Exact limits are per the standard; where the PDF tables are required, entries include 'lookup_required': true."
      ],
      "last_updated": "2025-08-29T19:57:10.089023"
    },
    "tables": {
      "mechanical_chemical_table_4_2": {
        "unit_system": "SI",
        "columns": [
          "grade",
          "tensile_min_MPa",
          "tensile_max_MPa",
          "yield_min_MPa",
          "max_thickness_mm",
          "max_percent_C_heat",
          "max_percent_C_product",
          "max_percent_P",
          "max_percent_S",
          "notes"
        ],
        "rows": [
          {
            "grade": "235d",
            "tensile_min_MPa": 360,
            "tensile_max_MPa": 510,
            "yield_min_MPa": 235,
            "max_thickness_mm": 20,
            "max_percent_C_heat": 0.2,
            "max_percent_C_product": 0.24,
            "max_percent_P": 0.04,
            "max_percent_S": 0.05,
            "notes": [
              "Yield/tensile ratio \u2264 0.75",
              "Nonrimming only"
            ]
          },
          {
            "grade": "250",
            "tensile_min_MPa": 400,
            "tensile_max_MPa": 530,
            "yield_min_MPa": 250,
            "max_thickness_mm": 40,
            "max_percent_C_heat": 0.23,
            "max_percent_C_product": 0.27,
            "max_percent_P": 0.04,
            "max_percent_S": 0.05,
            "notes": [
              "Yield/tensile ratio \u2264 0.75"
            ]
          },
          {
            "grade": "275",
            "tensile_min_MPa": 430,
            "tensile_max_MPa": 560,
            "yield_min_MPa": 275,
            "max_thickness_mm": 40,
            "max_percent_C_heat": 0.25,
            "max_percent_C_product": 0.29,
            "max_percent_P": 0.04,
            "max_percent_S": 0.05,
            "notes": [
              "Yield/tensile ratio \u2264 0.75"
            ]
          },
          {
            "grade": "ASTM A36",
            "lookup_required": true,
            "notes": [
              "4.2.2(a): up to ~40 mm typical"
            ],
            "tensile_min_MPa": 400,
            "tensile_max_MPa": 550,
            "yield_min_MPa": 250,
            "max_thickness_mm": 40,
            "max_percent_C_heat": 0.26,
            "max_percent_C_product": 0.29,
            "max_percent_P": 0.04,
            "max_percent_S": 0.05
          },
          {
            "grade": "ASTM A131 Grade A/B",
            "lookup_required": true,
            "notes": [
              "4.2.2(b): Grade A ~13 mm, Grade B thicker per spec"
            ]
          },
          {
            "grade": "CSA G40.21 260W/300W/350W",
            "lookup_required": true,
            "notes": [
              "4.2.3: 260W/300W up to 25\u201340 mm depending on killed/fine-grain; 350W up to 45 mm"
            ]
          },
          {
            "grade": "CSA G40.21 260WT/300WT/350WT",
            "lookup_required": true,
            "notes": [
              "WT variants (notch-tough)"
            ]
          },
          {
            "grade": "ISO 630 E275 (Qual. C/D)",
            "lookup_required": true,
            "notes": [
              "4.2.4(a): \u226440 mm"
            ]
          },
          {
            "grade": "ISO 630 E355 (Qual. C/D)",
            "lookup_required": true,
            "notes": [
              "4.2.4(b): \u226445 mm (insert \u226450 mm)"
            ]
          },
          {
            "grade": "EN 10025 S275 (J0/J2)",
            "lookup_required": true,
            "notes": [
              "4.2.5(a): \u226440 mm"
            ]
          },
          {
            "grade": "EN 10025 S355 (J0/J2/K2)",
            "lookup_required": true,
            "notes": [
              "4.2.5(b): \u226445 mm (insert \u226450 mm)"
            ]
          },
          {
            "grade": "National standard (per 4.2.6)",
            "lookup_required": true,
            "notes": [
              "Must meet Table 4.2 limits and be approved by Purchaser"
            ]
          },
          {
            "grade": "ASTM A131 Grade A",
            "lookup_required": true,
            "notes": [
              "Added per user list; populate Table 4.2 values."
            ],
            "tensile_min_MPa": 400,
            "tensile_max_MPa": 520,
            "yield_min_MPa": 235,
            "max_thickness_mm": 13,
            "max_percent_C_heat": 0.21,
            "max_percent_C_product": 0.23,
            "max_percent_P": 0.035,
            "max_percent_S": 0.035
          },
          {
            "grade": "ASTM A131 Grade B",
            "lookup_required": true,
            "notes": [
              "Added per user list; populate Table 4.2 values."
            ],
            "tensile_min_MPa": 400,
            "tensile_max_MPa": 520,
            "yield_min_MPa": 235,
            "max_thickness_mm": 25,
            "max_percent_C_heat": 0.21,
            "max_percent_C_product": 0.23,
            "max_percent_P": 0.035,
            "max_percent_S": 0.035
          },
          {
            "grade": "ASTM A283 Grade C",
            "lookup_required": true,
            "notes": [
              "Added per user list; populate Table 4.2 values."
            ],
            "tensile_min_MPa": 380,
            "tensile_max_MPa": 515,
            "yield_min_MPa": 205,
            "max_thickness_mm": 40,
            "max_percent_C_heat": 0.24,
            "max_percent_C_product": 0.27,
            "max_percent_P": 0.04,
            "max_percent_S": 0.05
          },
          {
            "grade": "ASTM A285 Grade C",
            "lookup_required": true,
            "notes": [
              "Added per user list; populate Table 4.2 values."
            ],
            "tensile_min_MPa": 485,
            "tensile_max_MPa": 620,
            "yield_min_MPa": 205,
            "max_thickness_mm": 40,
            "max_percent_C_heat": 0.28,
            "max_percent_C_product": 0.31,
            "max_percent_P": 0.035,
            "max_percent_S": 0.035
          },
          {
            "grade": "ASTM A516 Grade 380",
            "lookup_required": true,
            "notes": [
              "Added per user list; populate Table 4.2 values."
            ],
            "tensile_min_MPa": 380,
            "tensile_max_MPa": 515,
            "yield_min_MPa": 205,
            "max_thickness_mm": 65,
            "max_percent_C_heat": 0.23,
            "max_percent_C_product": 0.27,
            "max_percent_P": 0.035,
            "max_percent_S": 0.035
          },
          {
            "grade": "ASTM A516 Grade 415",
            "lookup_required": true,
            "notes": [
              "Added per user list; populate Table 4.2 values."
            ],
            "tensile_min_MPa": 415,
            "tensile_max_MPa": 550,
            "yield_min_MPa": 220,
            "max_thickness_mm": 65,
            "max_percent_C_heat": 0.24,
            "max_percent_C_product": 0.28,
            "max_percent_P": 0.035,
            "max_percent_S": 0.035
          },
          {
            "grade": "ASTM A516 Grade 450",
            "lookup_required": true,
            "notes": [
              "Added per user list; populate Table 4.2 values."
            ],
            "tensile_min_MPa": 450,
            "tensile_max_MPa": 585,
            "yield_min_MPa": 240,
            "max_thickness_mm": 65,
            "max_percent_C_heat": 0.26,
            "max_percent_C_product": 0.3,
            "max_percent_P": 0.035,
            "max_percent_S": 0.035
          },
          {
            "grade": "ASTM A516 Grade 485",
            "lookup_required": true,
            "notes": [
              "Added per user list; populate Table 4.2 values."
            ],
            "tensile_min_MPa": 485,
            "tensile_max_MPa": 620,
            "yield_min_MPa": 260,
            "max_thickness_mm": 65,
            "max_percent_C_heat": 0.27,
            "max_percent_C_product": 0.31,
            "max_percent_P": 0.035,
            "max_percent_S": 0.035
          },
          {
            "grade": "ASTM A537 Class 1",
            "lookup_required": true,
            "notes": [
              "Added per user list; populate Table 4.2 values."
            ],
            "tensile_min_MPa": 485,
            "tensile_max_MPa": 620,
            "yield_min_MPa": 345,
            "max_thickness_mm": 100,
            "max_percent_C_heat": 0.24,
            "max_percent_C_product": 0.27,
            "max_percent_P": 0.035,
            "max_percent_S": 0.035
          },
          {
            "grade": "ASTM A537 Class 2",
            "lookup_required": true,
            "notes": [
              "Added per user list; populate Table 4.2 values."
            ],
            "tensile_min_MPa": 585,
            "tensile_max_MPa": 690,
            "yield_min_MPa": 415,
            "max_thickness_mm": 100,
            "max_percent_C_heat": 0.24,
            "max_percent_C_product": 0.27,
            "max_percent_P": 0.035,
            "max_percent_S": 0.035
          },
          {
            "grade": "ASTM A573 Grade 400",
            "lookup_required": true,
            "notes": [
              "Added per user list; populate Table 4.2 values."
            ],
            "tensile_min_MPa": 400,
            "tensile_max_MPa": 550,
            "yield_min_MPa": 250,
            "max_thickness_mm": 50,
            "max_percent_C_heat": 0.27,
            "max_percent_C_product": 0.29,
            "max_percent_P": 0.035,
            "max_percent_S": 0.035
          },
          {
            "grade": "ASTM A573 Grade 450",
            "lookup_required": true,
            "notes": [
              "Added per user list; populate Table 4.2 values."
            ],
            "tensile_min_MPa": 450,
            "tensile_max_MPa": 620,
            "yield_min_MPa": 290,
            "max_thickness_mm": 50,
            "max_percent_C_heat": 0.27,
            "max_percent_C_product": 0.29,
            "max_percent_P": 0.035,
            "max_percent_S": 0.035
          },
          {
            "grade": "ASTM A573 Grade 485",
            "lookup_required": true,
            "notes": [
              "Added per user list; populate Table 4.2 values."
            ],
            "tensile_min_MPa": 485,
            "tensile_max_MPa": 655,
            "yield_min_MPa": 345,
            "max_thickness_mm": 50,
            "max_percent_C_heat": 0.27,
            "max_percent_C_product": 0.29,
            "max_percent_P": 0.035,
            "max_percent_S": 0.035
          },
          {
            "grade": "ASTM A633 Grade C",
            "lookup_required": true,
            "notes": [
              "Added per user list; populate Table 4.2 values."
            ],
            "tensile_min_MPa": 485,
            "tensile_max_MPa": 620,
            "yield_min_MPa": 345,
            "max_thickness_mm": 100,
            "max_percent_C_heat": 0.23,
            "max_percent_C_product": 0.26,
            "max_percent_P": 0.035,
            "max_percent_S": 0.035
          },
          {
            "grade": "ASTM A633 Grade D",
            "lookup_required": true,
            "notes": [
              "Added per user list; populate Table 4.2 values."
            ],
            "tensile_min_MPa": 510,
            "tensile_max_MPa": 655,
            "yield_min_MPa": 380,
            "max_thickness_mm": 100,
            "max_percent_C_heat": 0.23,
            "max_percent_C_product": 0.26,
            "max_percent_P": 0.035,
            "max_percent_S": 0.035
          },
          {
            "grade": "ASTM A662 Grade B",
            "lookup_required": true,
            "notes": [
              "Added per user list; populate Table 4.2 values."
            ],
            "tensile_min_MPa": 415,
            "tensile_max_MPa": 550,
            "yield_min_MPa": 240,
            "max_thickness_mm": 100,
            "max_percent_C_heat": 0.27,
            "max_percent_C_product": 0.31,
            "max_percent_P": 0.035,
            "max_percent_S": 0.035
          },
          {
            "grade": "ASTM A662 Grade C",
            "lookup_required": true,
            "notes": [
              "Added per user list; populate Table 4.2 values."
            ],
            "tensile_min_MPa": 450,
            "tensile_max_MPa": 585,
            "yield_min_MPa": 260,
            "max_thickness_mm": 100,
            "max_percent_C_heat": 0.27,
            "max_percent_C_product": 0.31,
            "max_percent_P": 0.035,
            "max_percent_S": 0.035
          },
          {
            "grade": "ASTM A678 Grade A",
            "lookup_required": true,
            "notes": [
              "Added per user list; populate Table 4.2 values."
            ],
            "tensile_min_MPa": 485,
            "tensile_max_MPa": 620,
            "yield_min_MPa": 345,
            "max_thickness_mm": 100,
            "max_percent_C_heat": 0.24,
            "max_percent_C_product": 0.27,
            "max_percent_P": 0.035,
            "max_percent_S": 0.035
          },
          {
            "grade": "ASTM A678 Grade B",
            "lookup_required": true,
            "notes": [
              "Added per user list; populate Table 4.2 values."
            ],
            "tensile_min_MPa": 515,
            "tensile_max_MPa": 655,
            "yield_min_MPa": 380,
            "max_thickness_mm": 100,
            "max_percent_C_heat": 0.24,
            "max_percent_C_product": 0.27,
            "max_percent_P": 0.035,
            "max_percent_S": 0.035
          },
          {
            "grade": "ASTM A737 Grade B",
            "lookup_required": true,
            "notes": [
              "Added per user list; populate Table 4.2 values."
            ],
            "tensile_min_MPa": 525,
            "tensile_max_MPa": 690,
            "yield_min_MPa": 415,
            "max_thickness_mm": 100,
            "max_percent_C_heat": 0.24,
            "max_percent_C_product": 0.27,
            "max_percent_P": 0.03,
            "max_percent_S": 0.03
          },
          {
            "grade": "ASTM A841 Grade A",
            "lookup_required": true,
            "notes": [
              "Added per user list; populate Table 4.2 values."
            ],
            "tensile_min_MPa": 485,
            "tensile_max_MPa": 620,
            "yield_min_MPa": 345,
            "max_thickness_mm": 100,
            "max_percent_C_heat": 0.2,
            "max_percent_C_product": 0.22,
            "max_percent_P": 0.025,
            "max_percent_S": 0.025
          },
          {
            "grade": "ASTM A841 Grade B",
            "lookup_required": true,
            "notes": [
              "Added per user list; populate Table 4.2 values."
            ],
            "tensile_min_MPa": 550,
            "tensile_max_MPa": 690,
            "yield_min_MPa": 415,
            "max_thickness_mm": 100,
            "max_percent_C_heat": 0.2,
            "max_percent_C_product": 0.22,
            "max_percent_P": 0.025,
            "max_percent_S": 0.025
          }
        ]
      },
      "temperature_dependence": {
        "modulus_of_elasticity_USC": [
          {
            "T_F": 200,
            "E_psi": 28800000
          },
          {
            "T_F": 300,
            "E_psi": 28300000
          },
          {
            "T_F": 400,
            "E_psi": 27700000
          },
          {
            "T_F": 500,
            "E_psi": 27300000
          }
        ],
        "interpolate_linear": true,
        "mdmt_curves": {
          "figures": [
            "Figure 4.1a (SI)",
            "Figure 4.1b (USC)"
          ],
          "lookup_required": true,
          "note": "Use figure or Table 4.3/4.5 linear equations to determine MDMT per material group and thickness."
        },
        "impact_test_tables": [
          "Table 4.3a/4.3b (material groups)",
          "Table 4.5a/4.5b (minimum impact test requirements)"
        ]
      },
      "table_5_2a_sd_st": {
        "unit_system": "SI",
        "columns": [
          "spec",
          "code",
          "grade",
          "t_range",
          "sd_MPa",
          "st_MPa"
        ],
        "rows": [
          {
            "spec": "ASTM A283M",
            "code": "A283C",
            "grade": "C",
            "t_range": "all",
            "sd_MPa": 137,
            "st_MPa": 154
          },
          {
            "spec": "ASTM A285M",
            "code": "A285C",
            "grade": "C",
            "t_range": "all",
            "sd_MPa": 137,
            "st_MPa": 154
          },
          {
            "spec": "ASTM A131M",
            "code": "A131A",
            "grade": "A",
            "t_range": "all",
            "sd_MPa": 157,
            "st_MPa": 171
          },
          {
            "spec": "ASTM A131M",
            "code": "A131B",
            "grade": "B",
            "t_range": "all",
            "sd_MPa": 157,
            "st_MPa": 171
          },
          {
            "spec": "ASTM A36M",
            "code": "A36",
            "grade": "\u2014",
            "t_range": "all",
            "sd_MPa": 160,
            "st_MPa": 171
          },
          {
            "spec": "ASTM A573M",
            "code": "A573Gr400",
            "grade": "400",
            "t_range": "all",
            "sd_MPa": 147,
            "st_MPa": 165
          },
          {
            "spec": "ASTM A573M",
            "code": "A573Gr450",
            "grade": "450",
            "t_range": "all",
            "sd_MPa": 160,
            "st_MPa": 180
          },
          {
            "spec": "ASTM A573M",
            "code": "A573Gr485",
            "grade": "485",
            "t_range": "all",
            "sd_MPa": 193,
            "st_MPa": 208
          },
          {
            "spec": "ASTM A516M",
            "code": "A516Gr380",
            "grade": "380",
            "t_range": "all",
            "sd_MPa": 137,
            "st_MPa": 154
          },
          {
            "spec": "ASTM A516M",
            "code": "A516Gr415",
            "grade": "415",
            "t_range": "all",
            "sd_MPa": 147,
            "st_MPa": 165
          },
          {
            "spec": "ASTM A516M",
            "code": "A516Gr450",
            "grade": "450",
            "t_range": "all",
            "sd_MPa": 160,
            "st_MPa": 180
          },
          {
            "spec": "ASTM A516M",
            "code": "A516Gr485",
            "grade": "485",
            "t_range": "all",
            "sd_MPa": 173,
            "st_MPa": 195
          },
          {
            "spec": "ASTM A662M",
            "code": "A662B",
            "grade": "B",
            "t_range": "all",
            "sd_MPa": 180,
            "st_MPa": 193
          },
          {
            "spec": "ASTM A662M",
            "code": "A662C",
            "grade": "C",
            "t_range": "all",
            "sd_MPa": 194,
            "st_MPa": 208
          },
          {
            "spec": "ASTM A537M",
            "code": "A537Cl1",
            "grade": "Class 1",
            "t_range": "all",
            "sd_MPa": 194,
            "st_MPa": 208
          },
          {
            "spec": "ASTM A537M",
            "code": "A537Cl2",
            "grade": "Class 2",
            "t_range": "t <= 65",
            "sd_MPa": 220,
            "st_MPa": 236
          },
          {
            "spec": "ASTM A537M",
            "code": "A537Cl2_t65_100",
            "grade": "Class 2",
            "t_range": "65 < t <= 100",
            "sd_MPa": 206,
            "st_MPa": 221
          },
          {
            "spec": "ASTM A633M",
            "code": "A633C",
            "grade": "C",
            "t_range": "t <= 65",
            "sd_MPa": 194,
            "st_MPa": 208
          },
          {
            "spec": "ASTM A633M",
            "code": "A633C_t65_100",
            "grade": "C",
            "t_range": "65 < t <= 100",
            "sd_MPa": 180,
            "st_MPa": 193
          },
          {
            "spec": "ASTM A633M",
            "code": "A633D",
            "grade": "D",
            "t_range": "t <= 65",
            "sd_MPa": 194,
            "st_MPa": 208
          },
          {
            "spec": "ASTM A633M",
            "code": "A633D_t65_100",
            "grade": "D",
            "t_range": "65 < t <= 100",
            "sd_MPa": 180,
            "st_MPa": 193
          },
          {
            "spec": "ASTM A737M",
            "code": "A737B",
            "grade": "B",
            "t_range": "all",
            "sd_MPa": 194,
            "st_MPa": 208
          },
          {
            "spec": "ASTM A841M",
            "code": "A841A",
            "grade": "Class 1 (A)",
            "t_range": "all",
            "sd_MPa": 194,
            "st_MPa": 208
          },
          {
            "spec": "ASTM A841M",
            "code": "A841B",
            "grade": "Class 1 (B)",
            "t_range": "all",
            "sd_MPa": 194,
            "st_MPa": 208
          },
          {
            "spec": "CSA G40.21M",
            "code": "CSA260W",
            "grade": "260W",
            "t_range": "all",
            "sd_MPa": 164,
            "st_MPa": 176
          },
          {
            "spec": "CSA G40.21M",
            "code": "CSA300W",
            "grade": "300W",
            "t_range": "all",
            "sd_MPa": 176,
            "st_MPa": 189
          },
          {
            "spec": "CSA G40.21M",
            "code": "CSA350W",
            "grade": "350W",
            "t_range": "all",
            "sd_MPa": 180,
            "st_MPa": 193
          },
          {
            "spec": "EN 10025",
            "code": "S275",
            "grade": "S275 (J0/J2)",
            "t_range": "<=16 & 16<t<=40 mapped",
            "sd_MPa": 164,
            "st_MPa": 176
          },
          {
            "spec": "EN 10025",
            "code": "S355",
            "grade": "S355 (J0/J2/K2)",
            "t_range": "<=16/40/50 mapped",
            "sd_MPa": 188,
            "st_MPa": 201
          }
        ],
        "source": "API 650 Table 5.2a (images provided)"
      }
    },
    "selection_rules": {
      "goal": "Recommend a material grade suitable for given temperature (T), pressure considerations (if any per app), and result thicknesses for shell/roof/bottom.",
      "clauses": [
        "4.2.1.4 thickness & heat treatment",
        "4.2.2\u20134.2.6 acceptable specifications",
        "4.2.9 impact testing",
        "Figures 4.1a/4.1b MDMT",
        "Tables 4.3/4.5 impact requirements"
      ],
      "algorithm": [
        "1) Identify controlling thickness t_req among components (e.g., max of shell courses, annular, roof).",
        "2) Filter materials where max_thickness >= t_req (or permitted with normalization per 4.2.1.4).",
        "3) For design metal temperature T (MDMT), use Figures 4.1 and Tables 4.3/4.5 to require impact-tested quality (e.g., 'WT' for CSA; J0/J2/K2 for EN) if necessary.",
        "4) If internal pressure > negligible, ensure selected plate spec and joint details meet any additional pressure check in Section 5 (or app\u2019s pressure criteria).",
        "5) Prefer higher yield/tensile materials (e.g., S355/E355, 350W) when uplift/seismic govern and weight reduction is desired, provided weldability and impact requirements are satisfied.",
        "6) Output top 3 candidate grades with rationale and any required heat treatment (normalized/TMCP) or impact testing."
      ],
      "output_fields": [
        "recommended_grades",
        "reasoning",
        "checks_passed",
        "required_tests_or_treatments"
      ]
    },
    "shell_material_options_5_2a": [
      "A283C",
      "A285C",
      "A131A",
      "A131B",
      "A36",
      "A573Gr400",
      "A573Gr450",
      "A573Gr485",
      "A516Gr380",
      "A516Gr415",
      "A516Gr450",
      "A516Gr485",
      "A662B",
      "A662C",
      "A537Cl1",
      "A537Cl2",
      "A633C",
      "A633D",
      "A737B",
      "A841A",
      "A841B",
      "CSA260W",
      "CSA300W",
      "CSA350W",
      "S275",
      "S355"
    ]
  },
  "functions": [
    {
      "name": "recommend_material_grade",
      "inputs": [
        "T_C",
        "P_bar",
        "thicknesses_mm",
        "region_standard_preference"
      ],
      "returns": [
        "recommended_grades",
        "rationale",
        "required_tests_or_treatments"
      ],
      "procedure": [
        "Compute controlling thickness t_req from 'thicknesses_mm'.",
        "Map T_C to MDMT and impact test requirements using material group and Figures 4.1/Table 4.3/4.5.",
        "Filter materials by Table 4.2 max thickness and mechanical property envelopes.",
        "Apply region_standard_preference to rank (e.g., EN in EU, IS/ASTM in India/US) if provided.",
        "Rank by (passes all checks) \u21d2 (impact-ready quality) \u21d2 (higher yield for weight reduction).",
        "Return the top 3 with reasons and any heat treatment/impact test notes."
      ]
    },
    {
      "name": "select_nozzle_nps_and_schedule",
      "inputs": [
        "required_flow_m3_h",
        "service",
        "design_pressure_bar",
        "design_temperature_C",
        "material",
        "corrosion_allowance_mm",
        "preferred_velocity_m_s",
        "available_NPS_schedules_table"
      ],
      "returns": [
        "selected_NPS_inch",
        "selected_schedule",
        "velocity_m_s",
        "pressure_allowable_bar",
        "reasoning"
      ],
      "procedure": [
        "Convert flow to m3/s. For each candidate NPS, compute inside diameter by schedule; compute velocity = Q / area.",
        "Pick smallest NPS that keeps velocity <= target for the service (defaults if not provided).",
        "From code tables (ASME B31.3/B36.10M) or Barlow formula, find minimum schedule that meets design pressure (with CA and temperature derating).",
        "Return chosen NPS & schedule with achieved velocity and pressure margin."
      ]
    },
    {
      "name": "evaluate_nozzle_loads_annexP",
      "inputs": [
        "D_tank_m",
        "shell_thickness_mm",
        "nozzle_neck_OD_mm",
        "reinforcement_type",
        "nozzle_elevation_m",
        "FR_N",
        "ML_Nm",
        "MC_Nm"
      ],
      "returns": [
        "allowable_FR_N",
        "allowable_ML_Nm",
        "allowable_MC_Nm",
        "utilization_ratios",
        "pass_fail",
        "notes"
      ],
      "procedure": [
        "Determine L/2a ratio and reinforcement case (reinforced on shell vs neck only).",
        "Use Annex P stiffness coefficients (Figures P.2a\u2013P.2l) to compute limit or allowable loads per P.2/P.3 methodology.",
        "Compare applied FR, ML, MC to allowable; report utilization and pass/fail."
      ]
    }
  ]
}